<!DOCTYPE html>
<html lang="en_US">
<head>
<link href="common.css" rel="stylesheet" type="text/css">
<link href="sprite.css" rel="stylesheet" type="text/css">
<link href="multi2.css" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
</head>
<body>
    <div class="ContentWrap">
        <div class="multi2">
            <div class="multi2__box">
                <ul class="multi2__list">
                    <template class="player_template">
                        <li class="multi2__item">
                            <div class="prev-seasons">
                                <button class="prev-seasons__btn prev-seasons__btn--active" value="11">
                                    <strong>Preseason</strong>
                                </button>
                                <button class="prev-seasons__btn " value="10"><strong>S2020</strong>
                                    Platinum</button>
                            </div>
                            <div class="summoner-summary">
                                <div class="last-updated">
                                    Last updated: <span class="_timeago _timeCountAssigned tip"
                                        data-datetime="1606939710" data-type="" data-interval="60"
                                        title="Dec 2 2020 12:08 PM">4 days ago</span>
                                </div>
                                <div class="tier-position">
                                    <div class="tier">
                                        <img class="tier__icon" src="platinum_4.png">
                                    </div>
                                    <div class="most-position">
                                        <i class="most-position__icon most-position__icon--MID"></i>
                                    </div>
                                </div>
                                <div class="summoner-name">
                                    <a class="name" href="#" target="_blank">
                                        null
                                    </a>
                                </div>
                                <div class="lp"></div>
                                <div class="graph">
                                    <div class="bar-graph">
                                        <div class="base">
                                            <div class="win" style="width: 50%">0W</div>
                                            0L
                                        </div>
                                        <span class="winratio">50%</span>
                                    </div>
                                </div>
                                <div class="win-streak win-streak--wins">
                                    3 game win streak
                                </div>
                            </div>
                            <div class="recent-matches">
                                <div class="title">Recently Played</div>
                                <div class="positions">
                                    <div class="position">
                                        <i class="position__icon position__icon--MID"></i>
                                        <div class="position__info">
                                            <div class="role-rate role-rate--high">80%</div>
                                            <div class="win-rate">W/R <strong>75%</strong></div>
                                        </div>
                                    </div>
                                    <div class="position">
                                        <i class="position__icon position__icon--TOP"></i>
                                        <div class="position__info">
                                            <div class="role-rate ">20%</div>
                                            <div class="win-rate">W/R <strong>0%</strong></div>
                                        </div>
                                    </div>
                                </div>
                                <ul class="recent-games">
                                </ul>
                            </div>
                        </li>
                    </template>
                </ul>
                <template class="recent_game_template">
                    <li class="recent-games__item">
                        <div class="champion __sprite __spc20 __spc20-2 tip" title="Akali"></div>
                        <img class="champion __sprite __spc20 __spc20-123 tip tpd-delegation-uid-1">
                        <div class="is-win is-win--true ">
                            <span class="kill"></span> /
                            <span class="death"></span> /
                            <span class="assist"></span>
                        </div>
                        <div class="time-stamp"><span
                            class="_timeago _timeCountAssigned tip tpd-delegation-uid-1"
                            data-datetime="1607304446" data-type="" data-interval="60"
                            title="Dec 6 2020 5:27 PM" data-toggle="tooltip">an hour ago</span></div>
                    </li>
                </template>
            </div>
        </div>
    </div>
</body>
<script>

    function timeConverter(UNIX_timestamp) {
        var a = new Date(UNIX_timestamp * 1000);
        var months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
        var year = a.getFullYear();
        var month = months[a.getMonth()];
        var date = a.getDate();
        var hour = a.getHours();
        var min = a.getMinutes();
        var sec = a.getSeconds();
        var time = date + ' ' + month + ' ' + year + ' ' + hour + ':' + min + ':' + sec;
        return time;
    }
    /*
    {
    "username":"FrankerZ",
    "rank":"Platinum 4 (40LP)",
    "wins":75,
    "losses":75,
    "lastupdate":"4 days ago",
    "streak":"+5"
    }
    */

    //OPGG Image URLS
    //https://opgg-static.akamaized.net/images/lol/champion/Talon.png

    ////window.location.href will get the params from the window
    //var queryString = window.location.href;

    //get data from url

    var user1Param = {
        "data": [{
            "all_champion_num": 152,
            "all_skin_num": 1144,
            "area_id": 31,
            "area_name": "\u5ce1\u8c37\u4e4b\u5dc5",
            "champion_num": 114,
            "game_age": 0,
            "game_id": 26,
            "game_level": 182,
            "game_logo_url": "https://wegame.gtimg.com/g.26-r.c2d3c/helper/lol/assis/images/resources/usericon/3861.png",
            "gender": 0,
            "league_point": 1115,
            "measure_unit": 0,
            "online_status": 0,
            "online_zone_id": 0,
            "power_value": 91761,
            "praise_time": 0,
            "rank": 0,
            "recent_kda": 893,
            "recent_total_games": 69,
            "recent_total_kill": 519,
            "recent_win_rate": 44,
            "result": 0,
            "role_name": "2020LYAMO1",
            "skin_num": 61,
            "slol_id": "5m3EjQ4odvB",
            "tier": 0,
            "total_assist": 12492,
            "total_games": 1557,
            "total_kill": 16623,
            "total_placed": 16152,
            "total_time": 7655674,
            "win_rate": 53
        }],
        "player_battle_brief_list": [
            {
                "assist_num": 8,
                "battle_id": 91193936,
                "battle_time": 1606638699,
                "champion_en_name": "Akali",
                "champion_id": 84,
                "death_num": 3,
                "ext_tag_desc": "\u7529\u9505\u5c40",
                "ext_tag_id": 10,
                "game_mode_id": 4,
                "game_mode_name": "\u5355\u53cc\u6392\u4f4d",
                "game_result": 2,
                "game_score": 950,
                "kill_num": 3,
                "position": 0,
                "pv_delta": -203
            },
            {
                "assist_num": 1,
                "battle_flags": [
                    3
                ],
                "battle_id": 91201414,
                "battle_time": 1606587622,
                "champion_en_name": "",
                "champion_id": 517,
                "death_num": 3,
                "ext_tag_desc": "\u7529\u9505\u5c40",
                "ext_tag_id": 10,
                "game_mode_id": 4,
                "game_mode_name": "\u5355\u53cc\u6392\u4f4d",
                "game_result": 2,
                "game_score": 880,
                "kill_num": 3,
                "position": 0,
                "pv_delta": -177
            },
            {
                "assist_num": 0,
                "battle_id": 91180250,
                "battle_time": 1606569239,
                "champion_en_name": "Akali",
                "champion_id": 84,
                "death_num": 6,
                "ext_tag_desc": "\u80cc\u9505\u5c40",
                "ext_tag_id": 2,
                "game_mode_id": 4,
                "game_mode_name": "\u5355\u53cc\u6392\u4f4d",
                "game_result": 2,
                "game_score": 400,
                "kill_num": 1,
                "position": 0,
                "pv_delta": -275
            },
            {
                "assist_num": 1,
                "battle_id": 91199717,
                "battle_time": 1606566739,
                "champion_en_name": "Jayce",
                "champion_id": 126,
                "death_num": 7,
                "ext_tag_desc": "\u80cc\u9505\u5c40",
                "ext_tag_id": 2,
                "game_mode_id": 4,
                "game_mode_name": "\u5355\u53cc\u6392\u4f4d",
                "game_result": 2,
                "game_score": 460,
                "kill_num": 3,
                "position": 0,
                "pv_delta": -261
            },
            {
                "assist_num": 4,
                "battle_flags": [
                    1
                ],
                "battle_id": 91169679,
                "battle_time": 1606564470,
                "champion_en_name": "",
                "champion_id": 246,
                "death_num": 1,
                "ext_tag_desc": "\u78be\u538b\u5c40",
                "ext_tag_id": 9,
                "ext_tag_ids": [
                    19
                ],
                "game_mode_id": 4,
                "game_mode_name": "\u5355\u53cc\u6392\u4f4d",
                "game_result": 1,
                "game_score": 1140,
                "kill_num": 10,
                "position": 0,
                "pv_delta": 317
            },
            {
                "assist_num": 12,
                "battle_id": 91179530,
                "battle_time": 1606562111,
                "champion_en_name": "Taric",
                "champion_id": 44,
                "death_num": 9,
                "ext_tag_desc": "\u80cc\u9505\u5c40",
                "ext_tag_id": 2,
                "game_mode_id": 4,
                "game_mode_name": "\u5355\u53cc\u6392\u4f4d",
                "game_result": 2,
                "game_score": 380,
                "kill_num": 2,
                "position": 0,
                "pv_delta": -282
            },
            {
                "assist_num": 4,
                "battle_id": 91169102,
                "battle_time": 1606559341,
                "champion_en_name": "Akali",
                "champion_id": 84,
                "death_num": 6,
                "ext_tag_desc": "\u7529\u9505\u5c40",
                "ext_tag_id": 10,
                "game_mode_id": 4,
                "game_mode_name": "\u5355\u53cc\u6392\u4f4d",
                "game_result": 2,
                "game_score": 760,
                "kill_num": 5,
                "position": 0,
                "pv_delta": -239
            },
            {
                "assist_num": 11,
                "battle_flags": [
                    1
                ],
                "battle_id": 91178901,
                "battle_time": 1606556426,
                "champion_en_name": "Renekton",
                "champion_id": 58,
                "death_num": 5,
                "game_mode_id": 4,
                "game_mode_name": "\u5355\u53cc\u6392\u4f4d",
                "game_result": 1,
                "game_score": 1250,
                "kill_num": 8,
                "position": 0,
                "pv_delta": 311
            },
            {
                "assist_num": 7,
                "battle_id": 91178587,
                "battle_time": 1606553209,
                "champion_en_name": "Akali",
                "champion_id": 84,
                "death_num": 5,
                "ext_tag_desc": "\u7529\u9505\u5c40",
                "ext_tag_id": 10,
                "game_mode_id": 4,
                "game_mode_name": "\u5355\u53cc\u6392\u4f4d",
                "game_result": 2,
                "game_score": 860,
                "kill_num": 5,
                "position": 3,
                "pv_delta": -213
            },
            {
                "assist_num": 2,
                "battle_id": 91165955,
                "battle_time": 1606496853,
                "champion_en_name": "",
                "champion_id": 517,
                "death_num": 6,
                "ext_tag_desc": "\u7529\u9505\u5c40",
                "ext_tag_id": 10,
                "game_mode_id": 4,
                "game_mode_name": "\u5355\u53cc\u6392\u4f4d",
                "game_result": 2,
                "game_score": 870,
                "kill_num": 3,
                "position": 0,
                "pv_delta": -212
            }]
    };

    var queryString = '1=' + JSON.stringify(user1Param) + '&2=' + JSON.stringify(user1Param) + '&3=' + JSON.stringify(user1Param) + '&4=' + JSON.stringify(user1Param) + '&5=' + JSON.stringify(user1Param);
    const urlParams = new URLSearchParams(queryString);
    const opggCDN = "	https://wegame.gtimg.com/g.26-r.c2d3c/helper/lol/assis/images/resources/champions/"
    i = 0;
    for (const [key, value] of urlParams) {
        jsonData = JSON.parse(value)
        console.log(jsonData)

        //begin create users
        var temp = document.getElementsByTagName("template")[0];
        var view = document.getElementsByClassName("multi2__list")[0];
        startElement = temp.content.querySelector("li");
        a = document.importNode(startElement, true);

        //
        var player = jsonData["data"][0]

        //populate user data from JSON
        a.getElementsByClassName("summoner-name")[0].innerHTML = "<a class='name' href='#'>" + player["role_name"] + "</a>"
        a.getElementsByClassName("lp")[0].innerText = player["league_point"] + "LP"
        a.getElementsByClassName("win")[0].innerText = player["win_rate"]
        view.appendChild(a);

        recentview = view.getElementsByClassName("recent-games")[i]
        var z = 0;

        var battle_list = jsonData["player_battle_brief_list"]

        while (Object.keys(battle_list).length > z) {
            //begin create user match history
            var recent_matches = document.getElementsByTagName("template")[1];
            recentList = recent_matches.content.querySelector("li");
            b = document.importNode(recentList, true);
            if (jsonData["player_battle_brief_list"][z]["champion_id"]) {
                b.getElementsByClassName("champion __sprite __spc20 __spc20-123 tip tpd-delegation-uid-1")[0].src = opggCDN + battle_list[z]["champion_id"] + ".png"
                b.getElementsByClassName("kill")[0].innerText = battle_list[z]["kill_num"]
                b.getElementsByClassName("death")[0].innerText = battle_list[z]["death_num"]
                b.getElementsByClassName("assist")[0].innerText = battle_list[z]["assist_num"]
                b.getElementsByClassName("_timeago _timeCountAssigned tip tpd-delegation-uid-1")[0].setAttribute("data-datetime", battle_list[z]["battle_time"]);
                b.getElementsByClassName("_timeago _timeCountAssigned tip tpd-delegation-uid-1")[0].innerText = timeConverter(battle_list[z]["battle_time"]);
                b.getElementsByClassName("_timeago _timeCountAssigned tip tpd-delegation-uid-1")[0].title = timeConverter(battle_list[z]["battle_time"]);
                $('[data-toggle="tooltip"]').tooltip(); 
                recentview.appendChild(b);
            }
            z += 1
        }
        //move to next players match history
        i += 1;
    }
</script>

</html>